Thanks to crosswind for providing the code. This is modified based on the following code.
https://github.com/Crosswind/wos-gift-code
